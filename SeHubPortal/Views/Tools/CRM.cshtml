
@{
    ViewBag.Title = "CRM";
    Layout = "~/Views/Shared/_ToolsLayout.cshtml";
}


@model SeHubPortal.ViewModel.CustomerReportingViewModel


<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>Dashboard</title>
    <meta charset="utf-8">
    @*<link rel="shortcut icon" type="image/x-icon" href="~/Content/title_logo64.png">*@
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"></script>

    @if (Model.SehubAccess.plant > 0)
    {
        <style>
            #PlantClicked {
                display: block !important;
            }
        </style>
    }

    @if (Model.SehubAccess.payroll > 0)
    {
        <style>
            #PayrollClicked {
                display: block !important;
            }
        </style>
    }

    @if (Model.SehubAccess.fleetTVT > 0)
    {
        <style>
            #FleetTVTClicked {
                display: block !important;
            }
        </style>
    }

    @if (Model.SehubAccess.treadTracker > 0)
    {
        <style>
            #treadTrackereClicked {
                display: block !important;
            }
        </style>
    }

    @if (Model.SehubAccess.library_access > 0)
    {
        <style>
            #libraryClicked {
                display: block !important;
            }
        </style>
    }

    @if (Model.SehubAccess.main > 0)
    {
        <style>
            #mainClicked {
                display: block !important;
            }
        </style>
    }

    @if (Model.SehubAccess.settings == 3)
    {
        <style>
            #SettingsClicked {
                display: block !important;
            }
        </style>
    }

    @if (Model.SehubAccess.management == 3)
    {
        <style>
            #ManagementClicked {
                display: block !important;
            }
        </style>
    }


    @if (Model.SehubAccess.tools_dashboard > 0)
    {
        <style>
            #DashboardLink {
                display: block !important;
            }
        </style>
    }

    @if (Model.SehubAccess.fuel_log > 0)
    {
        <style>
            #FuelLogLink {
                display: block !important;
            }
        </style>
    }

    @if (Model.SehubAccess.employee_id == 10577 || Model.SehubAccess.employee_id == 10901)
    {
        <style>
            #ExpnseClaimLink {
                display: block !important;
            }
        </style>
    }

    <style>

        #CRMLink {
            display: block !important;
        }

        #toolsClicked {
            display: block !important;
        }

        #toolsClicked {
            background-color: #f0f2f5;
        }

        #toolsBtn {
            font-weight: bold;
        }

        #dropArea {
            background: #b5b5b5;
            border: black dashed 1px;
            height: 50px;
            text-align: center;
            color: #fff;
            padding-top: 12px;
        }

        .active-drop {
            background: #77bafa !important;
            border: solid 2px blue !important;
            opacity: .5;
            color: black !important;
        }

        .modal {
            padding-right: 15%;
            overflow: hidden;
            margin-right: 0px;
        }

        ul#navigation .active {
            font-weight: bold;
        }

        #dropZone {
            border: 1px dotted red;
            text-align: center;
        }



        #CRMLink {
            color: black;
            font-weight: 700;
            background-color: #f0f2f5;
        }


        body {
            background-color: #f0f2f5;
            padding-right: 0 !important;
        }

        .heading {
            margin: 10px 0px 0px 0px;
        }

            .heading h2 {
                margin-top: 8px;
            }

        .card-header {
            background-color: #c0c2c4;
        }

            .card-header h6 {
                color: black;
            }

        #historyTable_info {
            display: none;
        }

        #historyTable2_info {
            display: none;
        }

        #historyTable3_info {
            display: none;
        }

        .dataTables_filter {
            float: right;
            height: 30px;
        }

        #historyTable_filter {
            display: none;
        }

        .breadCrumb {
            background-color: white;
        }

        #historyTable2_filter {
            float: right;
            margin: 0px 0px 25px 0px;
        }

        #historyTable3_filter {
            float: right;
            margin: 0px 0px 25px 0px;
        }

            #historyTable3_filter input {
                float: right;
                margin: 0px 2px 0px 10px;
            }

        #historyTable2_filter input {
            float: right;
            margin: 0px 2px 0px 10px;
        }

        .dataTables_filter input {
            width: 285px;
        }

        #historyTable_paginate {
            float: right;
        }

        #historyTable2_paginate {
            float: right;
        }

        #historyTable3_paginate {
            float: right;
        }

        label {
            display: inline-flex;
            margin-top: 0px;
            margin-bottom: 0px;
        }

        /* Hide scrollbar for Chrome, Safari and Opera */
        .example::-webkit-scrollbar {
            display: none;
        }

        /* Hide scrollbar for IE, Edge and Firefox */
        .example {
            -ms-overflow-style: none; /* IE and Edge */
            scrollbar-width: none; /* Firefox */
        }

        .dataTables_length {
            display: none
        }

        #CRMtable_filter{
            display:none
        }

        .hide {
            display: none;
        }

    </style>
</head>
<body>
    <div class="row heading">
        <div class="col" style="margin:0px 5px 15px 15px; padding:10px; background-color:white">
            <div style="display: flex; justify-content: space-between; align-items: center">
                <div style="flex:3">
                    <a href="@Url.Action("CRM", "Tools")">Tools </a>/ CRM
                </div>
                <div style="flex:3; display:flex; justify-content:space-around">
                    <input id="searchInput" onkeyup="filterOnClass('box', this.value)" style="width:200px;border-radius:4px; float:right " type="text" placeholder="Search with name" title="Type in a name">
                </div>
                <div style="flex:3; display:flex; justify-content:space-between; align-items:center">
                </div>
            </div>

        </div>
        <button type="button" id="clickThis" class="btn" style="margin-bottom:14px;">
            <i class="fa fa-bars" style="font-size:25px"></i>
            <span class="sr-only">Toggle Menu</span>
        </button>
    </div>

    <div class="row" style="padding: 0px 30px 0px 30px">
        <div class="col-md-2">
            <div class="row">
                <div class="col-md-12" style="padding-left:0px">
                    @if (Model.customerDetails != null)
                    {
                        <div class="row empButton active @Model.customerDetails.CustomerName @Model.customerDetails.CustomerCode" style="margin-left: 0px;cursor: pointer;font-weight: bold;padding: 15px;background-color: white" onclick="location.href='@Url.Action("CRM", "Tools", new { custID = @Model.customerDetails.CustomerCode})';">
                            <div style="display:flex; flex-direction:column">
                                @if (Model.customerDetails.CustomerName.Length > 24)
                                {
                                    <p style="padding:0px; margin:0px">@Model.customerDetails.CustomerName.Substring(0, 24)</p>
                                }
                                else
                                {
                                    <p style="padding:0px; margin:0px">@Model.customerDetails.CustomerName</p>
                                }
                                <p style="padding:0px; margin:0px">@Model.customerDetails.CustomerCode</p>
                            </div>
                        </div>
                    }
                </div>
            </div>
            <div class="row">
                <div class="col-md-12 example" style="height:70vh; overflow-y:auto; padding-right:0px; padding-left:0px; ">
                    @foreach (var items in Model.Customers)
                    {
                        if (items.Value != "Please Select Customer" && items.Value != Model.customerDetails.CustomerCode.ToString())
                        {
                            if (Model.customerDetails != null)
                            {
                                if (Model.customerDetails.CustomerCode.ToString() == items.Value)
                                {
                                    <div class="box row empButton active @items.Text.Split('(')[0] @items.Value" style="margin-left:0px; cursor: pointer; font-weight: bold; padding: 15px; background-color: white" onclick="location.href='@Url.Action("CRM", "Tools", new { custID = items.Value})';">
                                        <div style="display:flex; flex-direction:column">
                                            @if (items.Text.Split('(')[0].Length > 24)
                                            {
                                                <p style="padding:0px; margin:0px">@items.Text.Split('(')[0].Substring(0, 24)</p>
                                            }
                                            else
                                            {
                                                <p style="padding:0px; margin:0px">@items.Text.Split('(')[0]</p>
                                            }
                                            <p style="padding:0px; margin:0px">@items.Value</p>
                                        </div>
                                    </div>
                                }
                                else
                                {
                                    <div class="box row empButton active @items.Text.Split('(')[0] @items.Value" style="margin-left:0px; cursor:pointer; padding:15px; " onclick="location.href='@Url.Action("CRM", "Tools", new { custID = items.Value})';">
                                        <div style="display: flex; flex-direction: column">
                                            @if (items.Text.Split('(')[0].Length > 24)
                                            {
                                                <p style="padding:0px; margin:0px">@items.Text.Split('(')[0].Substring(0, 24)</p>
                                            }
                                            else
                                            {
                                                <p style="padding:0px; margin:0px">@items.Text.Split('(')[0]</p>
                                            }
                                            <p style="padding:0px; margin:0px">@items.Value</p>
                                        </div>
                                    </div>
                                }
                            }
                            else
                            {
                                <div class="box row empButton active @items.Text.Split('(')[0] @items.Value" style="margin-left:0px; cursor:pointer; padding:15px; " onclick="location.href='@Url.Action("CRM", "Tools", new { custID = items.Value})';">
                                    <div style="display:flex; flex-direction:column">
                                        @if (items.Text.Split('(')[0].Length > 24)
                                        {
                                            <p style="padding:0px; margin:0px">@items.Text.Split('(')[0].Substring(0, 24)</p>
                                        }
                                        else
                                        {
                                            <p style="padding:0px; margin:0px">@items.Text.Split('(')[0]</p>
                                        }
                                        <p style="padding:0px; margin:0px">@items.Value</p>
                                    </div>
                                </div>
                            }
                        }

                    }
                </div>
            </div>

        </div>
        @if (Model.Custname != null)
        {
            <div class="col-md-10" id="load" style="display:none">
                <div class="row" style="background-color:white; display:flex; justify-content:center; align-items:center; height:100%">
                    <img src="~/Content/giphy.gif" style="width:150px" alt="Alternate Text" />
                </div>
            </div>
            <div class="col-md-10" id="payRollMainBody" style="background-color:white; padding:15px;">
                <div id="report">
                    <div class="row" style="margin-bottom:10px">
                        <div class="col-md-12 text-left">
                            <button class="btn btn-primary" data-target="#AddCRM" data-toggle="modal" style="padding:2px 20px 2px 20px">ADD RECORD</button>
                        </div>
                    </div>
                    <div class="example" style="height:70vh; overflow-y:auto;">
                        <div class="row">
                            <div class="col-md-12">

                                <table id="CRMtable" class="table table-striped table-bordered">
                                    <thead style="background-color:#a6a8ab; color:white" class="text-center">
                                        <tr>
                                            <th style="font-size:10px; padding:0px">Date</th>
                                            <th style="font-size:10px; padding:0px">Employee</th>
                                            <th style="font-size:10px; padding:0px">Visit</th>
                                            <th style="font-size:10px; padding:0px">Contact</th>
                                            <th style="font-size:10px; padding:0px">Comments</th>
                                            <th style="font-size:10px; padding:0px">Reminders</th>
                                            <th style="font-size:10px; padding:0px">Info</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        @if (Model.Custname != null)
                                        {
                                            for (int i = 0; i < Model.customerReportingDetails.Count; i++)
                                            {
                                                <tr id="@i">
                                                    <td style="font-size:12px; font-weight:bold; text-align:center; padding:0px; vertical-align:middle">@Model.customerReportingDetails[i].visit_date.ToString("yyyy-MM-dd")</td>
                                                    <td style="font-size:12px; font-weight:bold; text-align:center; padding:0px; vertical-align:middle">@Model.customerReportingDetails[i].EmployeeName</td>
                                                    <td style="font-size:12px; font-weight:bold; text-align:center; padding:0px; vertical-align:middle">@Model.customerReportingDetails[i].visit_type</td>
                                                    <td style="font-size:12px; font-weight:bold; text-align:center; padding:0px; vertical-align:middle">@Model.customerReportingDetails[i].customer_contact</td>
                                                    <td style="font-size:12px; font-weight:bold; text-align:center; padding:0px; vertical-align:middle">
                                                        @if (Model.customerReportingDetails[i].discusssion_details.Length > 30)
                                                        {<span>@Model.customerReportingDetails[i].discusssion_details.Substring(0, 30)</span> }
                                                    else
                                                    { <span>@Model.customerReportingDetails[i].discusssion_details</span>}
                                                    </td>
                                                    <td style="font-size:12px; font-weight:bold; text-align:center; padding:0px; vertical-align:middle">
                                                        @if (Model.customerReportingDetails[i].remainder.Length > 30)
                                                        {<span>@Model.customerReportingDetails[i].remainder.Substring(0, 30)</span> }
                                                    else
                                                    { <span>@Model.customerReportingDetails[i].remainder</span>}
                                                    </td>
                                                    <td style="font-size:12px; font-weight:bold; text-align:center; padding:0px; vertical-align:middle">
                                                        <button value="@Model.customerReportingDetails[i].visit_type;@Model.customerReportingDetails[i].visit_date;@Model.customerReportingDetails[i].cta_employee_number;@Model.customerReportingDetails[i].customer_contact;@Model.customerReportingDetails[i].discusssion_details;@Model.customerReportingDetails[i].remainder;@Model.customerReportingDetails[i].EmployeeName;@Model.customerDetails.Telephone;@i;@Model.customerReportingDetails.Count" onclick="ViewCRM(this.value)" style="margin:5px; background-color:transparent; color:dodgerblue; border:none; outline:none; font-size:15px" class="fa fa-info" data-toggle="modal" data-target="#CallReportingModal"></button>
                                                    </td>
                                                </tr>
                                            }
                                        }
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        }
        else
        {
            <div class="col-md-9" id="loadDiv" style="background-color:#f0f2f5; padding:15px;">

            </div>
        }
    </div>

    <div class="modal fade" id="AddCRM" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content" style="width:700px">
                @using (Html.BeginForm("AddNewCRMDetails", "Tools", FormMethod.Post))
                {
                    @Html.HiddenFor(m => m.customerDetails.CustomerCode)
                    @Html.HiddenFor(m => m.customerDetails.CustomerName)
                    <div class="modal-header" style="padding: 3px 3px 3px 15px">
                        <h5 class="modal-title" id="exampleModalLabel">
                            <b>
                                @Model.Customers.Where(x => x.Value == Model.Custname).Select(x => x.Text).FirstOrDefault()
                            </b>
                        </h5>
                    </div>
                    <div class="modal-body">
                        <div class="row" style="margin-top:30px">
                            <div class="col-lg-12">
                                <div class="row">
                                    <div class="col-lg-6">
                                        <div class="row">
                                            <div class="col-lg-4">
                                                Visit Type
                                            </div>
                                            <div class="col-lg-8">
                                                @{
                                                    List
                                                    <SelectListItem>
                                                    listItems = new List
                                                    <SelectListItem>
                                                    ();
                                                    listItems.Add(new SelectListItem
                                                    {
                                                        Text = "Select",
                                                        Value = ""
                                                    });
                                                    listItems.Add(new SelectListItem
                                                    {
                                                        Text = "Phone",
                                                        Value = "Phone"
                                                    });
                                                    listItems.Add(new SelectListItem
                                                    {
                                                        Text = "Face-To-Face",
                                                        Value = "Face-To-Face"
                                                    });
                                                }
                                                @Html.DropDownListFor(m => m.AddCRM.visit_type, listItems, new { @id = "CRMVisitType", @class = "text", @style = "width:100%; height:30px", @required = "required", @onchange = "checkRequiredCRM()" })
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-6">
                                        <div class="row">
                                            <div class="col-lg-4">
                                                Employee
                                            </div>
                                            <div class="col-lg-8 text-right">
                                                <input style="width:91%" id="UserName" class="text-left" type="text" value="@Model.username" />
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row" style="margin-top:20px">
                                    <div class="col-lg-6">
                                        <div class="row">
                                            <div class="col-lg-4">
                                                Visit Date
                                            </div>
                                            <div class="col-lg-8">
                                                @Html.EditorFor(m => m.AddCRM.visit_date, new { htmlAttributes = new { @max = System.DateTime.Today.ToString("yyyy-MM-dd"), @id = "CRMVisitDate", @class = "text-left", @type = "date", @style = "width:100%", @required = "required", @onchange = "checkRequiredCRM()" } })

                                            </div>
                                        </div>
                                    </div>

                                    <div class="col-lg-6">
                                        <div class="row">
                                            <div class="col-lg-4">
                                                Contact
                                            </div>
                                            <div class="col-lg-8 text-right">
                                                @Html.EditorFor(m => m.AddCRM.customer_contact, new { htmlAttributes = new { @id = "CRMContact", @class = "text-left", @required = "required", @style = "width:91%", @onkeyup = "checkRequiredCRM()" } })
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row" style="padding:20px 15px 0px 15px">
                                    @*<textarea class="col-lg-12" rows="7"></textarea>*@
                                    @Html.TextAreaFor(m => m.AddCRM.discusssion_details, 5, 121, new { @id = "CRMComments", @placeholder = " Comments", @required = "required", @onkeyup = "checkRequiredCRM()" })
                                </div>
                                <div class="row" style="padding:20px 15px 0px 15px">
                                    @*<textarea class="col-lg-12" rows="5"></textarea>*@
                                    @Html.TextAreaFor(m => m.AddCRM.remainder, 3, 121, new { @placeholder = " Reminders(Optional)" })
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer" style="padding: 3px 3px 3px 15px">
                        <button type="button" class="btn btn-danger" style="padding:3px 30px 3px 30px; margin-right:10px" data-dismiss="modal">Cancel</button>
                        <input type="submit" id="crmSubmit" class="btn btn-success" style="display:none; padding:3px 30px 3px 30px; " value="Submit" />
                    </div>
                }

            </div>
        </div>
    </div>

    <div class="modal fade" id="CallReportingModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content" style="width:700px">
                <div class="modal-header" style="padding:3px">
                    <div class="col-lg-3 text-left" style="padding-top:5px">
                        <button id="backwordButton" onclick="backward()" class="btn btn-primary" style="font-size:20px; padding:0px 5px 1px 5px"><b><</b></button>
                    </div>
                    <div class="col-lg-6 text-center" style="padding:10px 0px 0px 0px">
                        <h5>Call Reporting Details</h5>
                    </div>
                    <div class="col-lg-3 text-right" style="padding-top:5px">
                        <button id="forwardButton" onclick="forward()" class="btn btn-primary" style="font-size:20px; padding:0px 5px 1px 5px"><b>></b></button>
                    </div>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="clo-lg-2" style="margin-left:20px; margin-right:auto; margin-top: 0px;">
                            <p>Visit type </p>
                        </div>
                        <div class="col-lg-4 text-right" style="margin-right: auto;"><input class="text-center" readonly type="text" id="append_Visit_type" style="text-align:right;" /><br /></div>
                        <div class="clo-lg-2" style="margin-left: 10px; margin-top: 0px;">
                            <p>Date :</p>
                        </div>
                        <div class="col-lg-4 text-right" style="margin-left: 20px;"><input class="text-center " type="text" id="append_Date" /><br /></div>
                    </div>
                    <div class="row">
                        <div class="clo-lg-2" style="margin-left: 20px; margin-right:auto;margin-top: 0px;">
                            <p>Employee </p>
                        </div>
                        <div class="col-sm-4 text-right" style="margin-right: auto;"><input class="text-center" readonly type="text" id="append_empId" /><br /></div>
                        <div class="clo-lg-2" style="margin-left: 10px;margin-top: 0px;">
                            <p>Contact :</p>
                        </div>
                        <div class="col-sm-4 text-right"><input class="text-center " readonly type="text" id="appendc_Contact" /><br /></div>
                    </div>
                    <div class="row">
                        <div class="clo-lg-12" style="margin-left: 20px">
                            <p>Comments </p>
                        </div>
                    </div>
                    <div class="row" style="margin-left:auto; margin-right:auto;">
                        <textarea class="col-lg-12" style="margin-left:auto; margin-right:auto;" id="append_Comments" readonly rows="8"></textarea>
                    </div>
                    <div class="row" style="margin-top:15px">
                        <div class="clo-lg-12" style="margin-left: 20px">
                            <p>Remainders </p>
                        </div>
                    </div>
                    <div class="row" style="margin-left:auto; margin-right:auto;">
                        <textarea class="col-lg-12" id="append_Remainders" readonly rows="6"></textarea>
                        <input style="display:none" type="text" id="index" name="name" value="" />
                        <input style="display:none" type="text" id="count" name="name" value="" />
                    </div>
                </div>
                <div class="modal-footer" style="padding: 3px 3px 3px 15px">
                    <button type="button" style="padding: 3px 20px 3px 20px" class="btn btn-danger" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/1.10.20/js/jquery.dataTables.min.js"></script>
    <link href="https://cdn.datatables.net/1.10.20/css/jquery.dataTables.css" rel="stylesheet" type="text/css" />

    <script>
        function filterOnClass(baseClass, s) {
            let re = new RegExp(s.trim(), 'i');
            document.querySelectorAll('.' + baseClass).forEach(node => {
                let cNames = Array.from(node.classList);
                // Show all if search string is blank
                if (s.trim() == '') {
                    node.classList.remove('hide');
                    // Otherwise, filter
                } else if (cNames.some(cName => re.test(cName))) {
                    node.classList.remove('hide');
                } else {
                    node.classList.add('hide');
                }
            });
        }
    </script>

    <script type="text/javascript">
        $("#CRMtable").DataTable(
            {
                bLengthChange: true,
                lengthMenu: [19],
                bFilter: true,
                bSort: false,
                bPaginate: true,
            });


    </script>

    <script>

        function ViewCRM(val) {
            var array = val.split(";");
            $('#append_Visit_type').val(array[0]);
            $('#append_Date').val(array[1].split("").slice(0, 10).join(""));
            $('#append_empId').val(array[6])
            $('#appendc_Contact').val(array[3])
            document.getElementById("append_Comments").value = array[4];
            document.getElementById("append_Remainders").value = array[5];

            $('#apped_AddButton_empname').val(array[6])
            $('#index').val(array[8])
            $('#count').val(array[9])

            if (parseInt($('#index').val()) < 1) {
                $('#backwordButton').prop('disabled', true);
            }
            else {
                $('#backwordButton').prop('disabled', false);
            }

            if (parseInt($('#index').val()) >= parseInt($('#count').val()) - 1) {
                $('#forwardButton').prop('disabled', true);
            }
            else {
                $('#forwardButton').prop('disabled', false);
            }
        }

        $(document).ready(function () {

            $('#searchCR').click(function () {
                var value = $("#myInput").val().toLowerCase();
                $("#callReport tr").filter(function () {
                    $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
                });
            });

            $('#searchTA').click(function () {
                var value = $("#myInputTA").val().toLowerCase();
                $("#targetAccount tr").filter(function () {
                    $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
                });
            });


        });
    </script>



    <script>



        function checkRequiredCRM() {
            if ($('#CRMVisitType option:selected').text() != 'Select' && $('#CRMVisitDate').val() != "" && $('#CRMContact').val() != "" && $('#CRMComments').val() != "") {
                $('#crmSubmit').css("display", "block")
            }
            else {
                $('#crmSubmit').css("display", "none")
            }
        }

        function forward() {

            let NextRow = parseInt($('#index').val()) + 1;


            if (NextRow >= parseInt($('#count').val())) {
            }
            else {

                if (NextRow >= parseInt($('#count').val()) - 1) {
                    $('#forwardButton').prop('disabled', true);
                }

                if (NextRow >= 0) {
                    $('#backwordButton').prop('disabled', false);
                }

                //alert(NextRow, $('#count').val())

                $('#index').val(NextRow);

                var currentRow = $('#' + NextRow).closest("tr");


                $('#append_Visit_type').val(currentRow.find("td:eq(0)").text());
                $('#append_Date').val(currentRow.find("td:eq(1)").text());
                $('#apped_AddButton_empname').val(currentRow.find("td:eq(2)").text())
                $('#appendc_Contact').val(currentRow.find("td:eq(3)").text())
                document.getElementById("append_Comments").value = currentRow.find("td:eq(4)").text();
                document.getElementById("append_Remainders").value = currentRow.find("td:eq(5)").text();
            }





        }

        function backward() {

            let NextRow = parseInt($('#index').val()) - 1;
            if (NextRow < 0) {

            }
            else {

                if (NextRow < 1) {
                    $('#backwordButton').prop('disabled', true);
                }

                //alert(NextRow)

                if (NextRow <= parseInt($('#count').val())) {
                    $('#forwardButton').prop('disabled', false);
                }


                $('#index').val(NextRow);

                var currentRow = $('#' + NextRow).closest("tr");


                $('#append_Visit_type').val(currentRow.find("td:eq(0)").text());
                $('#append_Date').val(currentRow.find("td:eq(1)").text());
                $('#apped_AddButton_empname').val(currentRow.find("td:eq(2)").text())
                $('#appendc_Contact').val(currentRow.find("td:eq(3)").text())
                document.getElementById("append_Comments").value = currentRow.find("td:eq(4)").text();
                document.getElementById("append_Remainders").value = currentRow.find("td:eq(5)").text();
            }

        }


        $(document).ready(function () {





            $('#targetAccount a').click(function (e) {

                e.preventDefault()
                $that = $(this);
                $that.parent().find('a');

                var seleccionado = $(this).children("span").html();

                $('#targetAccountModal').modal();

                var array = seleccionado.split(";");
                $('#append_Visit_type1').val(array[1]);
                $('#append_Date1').val(array[2].split("").slice(0, 11).join(""))
                $('#append_empId1').val(array[3])
                $('#appendc_Contact1').val(array[4])
                $('#apped_AddButton_empname1').val(array[6])
                document.getElementById("append_Comments1").value = array[5];
                document.getElementById("append_Remainders1").value = array[6];


            });

            $('#disputeResolution a').click(function (e) {

                e.preventDefault()
                $that = $(this);
                $that.parent().find('a');

                var seleccionado = $(this).children("span").html();

                $('#disputeResolutionModal').modal();

                //alert(seleccionado)

                var array = seleccionado.split(";");

                //alert(seleccionado);

                $('#append_Visit_type').val(array[0]);
                $('#append_Date').val(array[1].split("").slice(0, 10).join(""))
                $('#append_empId').val(array[6])
                $('#appendc_Contact').val(array[3])
                $('#apped_AddButton_empname').val(array[6])
                document.getElementById("append_Comments").value = array[4];
                document.getElementById("append_Remainders").value = array[5];

            });





        });

        $(".box").click(function () {
            $('#load').css('display', 'block')
            $('#payRollMainBody').css('display', 'none')
        });

    </script>
</body>
</html>





